<!DOCTYPE html>
<html lang="en">

<head>
  <title>DK: Multi GLUT</title>
</head>

<body>

<h1><a href="index.html">Dmitry Kurtaev/</a> C++: Multiply GLUT windows</h1>
<p>
<b>Problem:</b> use separate GLUT windows with own callbacks and drawing functions.<br>
<b>Example:</b> written on C++, freeglut.<br>
<b>Languages:</b>
<a href="multiply_glut_windows.html">EN</a>,
<a href="multiply_glut_windows_ru.html">RU</a>
</p>

<h2>Table of contents</h2>
&bull; <a href="#single_window">Single classic window</a><br>
&bull; <a href="#two_windows">Two classic windows</a><br>
&bull; <a href="#single_glview">Single window as class object</a><br>
&bull; <a href="#two_glviews">Abstract views manager</a><br>
&bull; <a href="#subwindows">GLUT subwindows</a><br>
&bull; <a href="#references">Useful links</a>

<p>
<h2 id="single_window">Single classic window</h2>
GLUT is a library for OpenGL.
It provides windows manipulations: create, reshape, receive user's callbacks and
display OpenGL's drawings stored in buffers.<br>
Minimal usage includes GLUT and window initialization, settings references to
callback functions by specific events.
</p>

<table>
  <td width="50%" valign="top">
    <script src="code_samples/multi_glut_single_window_main.cpp"></script>
  </td>

  <td width="50%" valign="top">
    <script src="code_samples/multi_glut_single_window_display.cpp"></script>
  </td>
</table>

<p>
Created window inherits OS's windows style.
At pictures it is running on Ubuntu 16.04LTS.<br>
<img src="images/single_window_triangle.png" alt="Single view"><br>
Addition: GLUT is a powerful but simple windows manager. We can not make some
OS-like operations like hiding window's header or keep window always on top of
other windows.
</p>

<h2 id="two_windows">Two classic windows</h2>
<p>
We initializing two windows sequently. For each write own display function.
</p>

<table>
  <td width="50%" valign="bottom">
    <script src="code_samples/multi_glut_two_windows_main.cpp"></script>
  </td>

  <td width="50%" valign="bottom">
    <script src="code_samples/multi_glut_two_windows_display.cpp"></script>
  </td>
</table>

<img src="images/two_windows_classic.png" alt="Two views"><br>

<h2 id="single_glview">Single window as class object</h2>
<p>
Generally, problem is solved. But in future we may want to have more than two
windows and with more harder callbacks logic. Let's try encapsulate window
managment inside class for more scalability.<br>
Make step backward to single window problem and implement class with same usage.
</p>

<script src="code_samples/multi_glut_single_glview_header.cpp"></script>

<p>
Header of our class has all that we need. User choose window title only.
Now main function use single line for create similar window. In sight of class
user it is easy to use without care about internal implementation.
</p>

<script src="code_samples/multi_glut_single_glview_main.cpp"></script>

<p>
In sight of class we just encpsulated existing usage inside corresponding
methods. Note that functions is static. It is required for registering
callbacks.
</p>

<table>
  <td width="50%" valign="bottom">
    <script src="code_samples/multi_glut_single_glview_constructor.cpp"></script>
  </td>

  <td width="50%" valign="bottom">
    <script src="code_samples/multi_glut_single_glview_display.cpp"></script>
  </td>
</table>

<h2 id="two_glviews">Abstract views manager</h2>

<p>
We need to provide few windows management. Due to display function is static, it
is same for different class objects. But we need to separate displaying.<br>
Let's make display as abstract function that will be implemented inside
an inherited classes. As callback we calling each display of created window.
</p>

<script src="code_samples/multi_glut_two_glviews_header.cpp"></script>

<p>
We will see that display_all function is registered as callback for each window
i.e. in case of single display request we redisplay every other window.
</p>

<table>
  <td width="50%" valign="bottom">
    <script src="code_samples/multi_glut_two_glviews_constructor.cpp"></script>
  </td>

  <td width="50%" valign="top">
    <script src="code_samples/multi_glut_two_glviews_display_wrong.cpp"></script>
  </td>
</table>

Before we had different functions for different windows. Now we have problem
with window identification. If unroll a loop inside display_all method, only
last iteration is actual because it has own glClear(..) and glutSwapBuffers(..)
calls that overwrites previous changes.<br>
For solving problem we using glutSetWindow(..). It sets current window for
which applying future commands.

<script src="code_samples/multi_glut_two_glviews_display_correct.cpp"></script>

<p>
For new window we implements class with own display.
</p>

<table>
  <td width="50%" valign="bottom">
    <script src="code_samples/multi_glut_two_glviews_first_view.cpp"></script>
  </td>

  <td width="50%" valign="bottom">
    <script src="code_samples/multi_glut_two_glviews_second_view.cpp"></script>
  </td>
</table>

<h2 id="subwindows">GLUT subwindows</h2>
<p>
In addition let's try merge two windows inside single window. But each subwindow
has own callbacks.<br>
GLUT has method glutCreateSubWindow(..) which creates new window in space of
existing parent window.
</p>

<script src="code_samples/multi_glut_subwindows_constructor.cpp"></script>

<img src="images/subwindow.png" alt="Subwindow"><br>

<p>
Addition: subwindow has constant shape although parent size changes. If needed,
we can make own child reshape using relative coordinates and parent's reshape
callback.
</p>

<h2 id="references">Useful links</h2>
<a href=https://www.opengl.org/sdk/docs/man2/xhtml>OpenGL 2.1 Reference Pages</a><br>
<a href=http://freeglut.sourceforge.net/docs/api.php>freeglut API</a>

</body>
</html>
